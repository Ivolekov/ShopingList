@model ShopingList.Data.Models.GroceryList

@{
    ViewData["Title"] = "Details";
    Layout = "~/Pages/Shared/_Layout.cshtml";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

<div>
    <h4>Grocery List - @Html.DisplayFor(model => model.Title)</h4>
    <div class="my-2">
        <a asp-action="Edit" asp-route-id="@Model.Id">Edit</a> |
        <a asp-action="Index">Back to shoping lists</a>
    </div>
    <hr />
    @using (Html.BeginForm("AddProduct", "ShopingList"))
    {
    <div class="ui-widget">
            <label for="productName">Search Product: </label>
            @Html.TextBox("productName")
            @Html.Hidden("id")
            <input class="btn btn-sm btn-success fw-bold" type="submit" value="Add"/>
    </div> 
    }
    @await Html.PartialAsync("_GroceriesListProducts", @Model)
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        $(function () {
            $('#productName').autocomplete({
                source: function(request, response) {
                    $.ajax({
                        url: "/Products/GetProductsList",
                        data: { "prefix": request.term },
                        type: "POST",
                        success:function(data) {
                             response($.map(data, function(item) {
                                return item.name;
                             }));
                        },
                        error: function(res) {
                            alert(res.responseText);
                        }
                    })
                }
            });
        });
    </script>
}